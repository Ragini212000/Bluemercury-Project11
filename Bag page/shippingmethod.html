<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shipping method - bluemercury - Checkout</title>
    <style>
      #parent {
        display: flex;
        color: rgb(102, 102, 102);
      }
      #child1 {
        width: 60%;
      }
      #child2 {
        width: 45%;
        background-color: rgb(248, 248, 248);
      }
      img {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 30%;
      }
      #links {
        display: flex;
        width: 40%;
        margin: auto;
        margin-top: 30px;
      }
      #contacttable,
      #shippingtable {
        border: 2px solid rgb(230, 230, 230);
        width: 80%;
        margin: auto;
        height: 18%;
      }
      #boxtr > td {
        border-bottom: 2px solid rgb(230, 230, 230);
      }
      #shippingtable > tbody > tr:first-child > td {
        border-bottom: 2px solid rgb(230, 230, 230);
      }
      td {
        padding: 20px;
      }
      h3 {
        width: 80%;
        margin: auto;
        margin-top: 50px;
        margin-bottom: 40px;
      }
      #submitdiv {
        display: flex;
        justify-content: space-between;
        width: 80%;
        margin: auto;
        margin-top: 50px;
      }
      #submitdiv + a {
        padding-top: 30px;
      }
      input[type="submit"] {
        background-color: rgb(18, 40, 76);
        color: white;
        cursor: pointer;
        font-weight: bolder;
        font-size: 15px;
        border: none;
        padding: 25px;
        margin-left: auto;
      }
      .vertical {
        border-left: 2px solid rgb(220, 220, 220);
        height: 100%;
        position: absolute;
        left: 57%;
      }
      #promo {
        width: 80%;
        margin: auto;
      }
      #promocode {
        width: 270px;
        padding: 15px;
        margin-right: -5px;
        font-size: medium;
        margin-left: 25px;
      }
      #promobutton {
        width: 210px;
        padding: 17px;
        background-color: rgb(18, 40, 76);
        color: white;
        font-weight: bolder;
        font-size: medium;
      }
      #promo + hr {
        width: 70%;
        border-top: 1px solid rgb(220, 220, 220);
      }
      #td1 {
        display: flex;
        margin: auto;
        left: 0;
      }
      #child2 > table {
        margin: auto;
      }
      #child2 > table:first-child {
        width: 75%;
        height: 50%;
      }
      #carttext {
        text-align: left;
        margin-right: -100px;
      }
      #cartimg {
        width: 13%;
        height: 13%;
        border: 0.1px solid rgb(220, 220, 220);
        border-radius: 7px;

        margin-left: -20px;
        margin-right: 20px;
      }
      #cartottable {
        width: 70%;
      }
      #cartottable > tbody > tr > td {
        padding: 10px;
        color: rgb(18, 40, 76);
        font-size: large;
      }
      #cartottable > tbody > tr > td:last-child {
        text-align: end;
      }
      #cartottable > tbody > tr:last-child > td {
        border-top: 1px solid rgb(220, 220, 220);
      }
      a {
        text-decoration: none;
        color: rgb(102, 102, 102);
        font-size: large;
      }
      a:visited {
        color: rgb(18, 40, 76);
      }
    </style>
  </head>
  <body>
    <div id="parent">
      <div id="child1">
        <img
          src="https://cdn.shopify.com/s/files/1/0283/0185/2747/files/blm-checkout-logo.png?129696"
          alt=""
        />
        <div id="links">
          <div><a href="ProductPage.html"> Cart &nbsp &nbsp > </a></div>
          <div>
            <a href="CustomerInfoPage.html">
              &nbsp &nbsp Customer Information &nbsp &nbsp ></a
            >
          </div>
          <div>
            <a href="shippingmethod.html">
              &nbsp &nbsp Shipping method &nbsp &nbsp ></a
            >
          </div>
        </div>
        <h3>Contact Information</h3>
        <table id="contacttable">
          <tbody>
            <tr id="boxtr"></tr>
            <tr id="shiptotr"></tr>
          </tbody>
        </table>
        <h3>Shipping method</h3>
        <table id="shippingtable">
          <tbody>
            <tr>
              <td>
                <input
                  value="1"
                  id="type_radio_1"
                  name="type_radio"
                  type="radio"
                />
              </td>
              <td>Ground Shipping (7-10 days)</td>
              <td>Free</td>
            </tr>
            <tr>
              <td>
                <input
                  value="2"
                  id="type_radio_2"
                  name="type_radio"
                  type="radio"
                />
              </td>
              <td>Two-Day Shipping (Excludes PO Box or APO/FPO)</td>
              <td>$10.00</td>
            </tr>
          </tbody>
        </table>
        <div id="submitdiv">
          <a href="CustomerInfoPage.html">
            <span>&nbsp < &nbsp </span> RETURN TO INFORMATION</a
          >
          <a href="paymentmethod.html">
            <input type="submit" value="CONTINUE TO PAYMENT" />
          </a>
        </div>
      </div>
      <div class="vertical"></div>
      <div id="child2">
        <table>
          <tbody id="carttablebody"></tbody>
        </table>
        <div id="promo">
          <input
            type="text"
            placeholder="Gift Card/Promo Code"
            id="promocode"
          />
          <input type="submit" value="Apply" id="promobutton" />
        </div>
        <hr />
        <table id="cartottable">
          <tbody>
            <tr>
              <td>Subtotal</td>
              <td id="subtot"></td>
            </tr>
            <tr>
              <td>Shipping</td>
              <td>Free</td>
            </tr>
            <tr class="hrclass">
              <td>Total</td>
              <td id="totprice"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
<script>
  var customerdata = JSON.parse(localStorage.getItem("customer-data")) || [];
  document.querySelector("#type_radio_1").addEventListener("click", method1fun);
  document.querySelector("#type_radio_2").addEventListener("click", method2fun);
  var obj = customerdata[customerdata.length - 1];
  displayinfo();
  console.log(obj);
  function displayinfo() {
    var contact = document.createElement("td");
    contact.textContent = "Contact";
    var contacttext = document.createElement("td");
    contacttext.textContent = obj.email;
    var change1 = document.createElement("td");
    var anchor1 = document.createElement("a");
    anchor1.textContent = "change";
    anchor1.setAttribute("href", "./CustomerInfoPage.html");
    change1.append(anchor1);
    document.querySelector("#boxtr").append(contact, contacttext, change1);
    var shiptotr = document.createElement("tr");
    var shipto = document.createElement("td");
    shipto.textContent = "Ship to";
    var shiptotext = document.createElement("td");
    shiptotext.textContent =
      obj.address1 +
      "," +
      " " +
      obj.city +
      " " +
      obj.state +
      " " +
      obj.pincode +
      "," +
      " " +
      obj.country;
    var change2 = document.createElement("td");
    var anchor2 = document.createElement("a");
    anchor2.textContent = "change";
    anchor2.setAttribute("href", "./CustomerInfoPage.html");
    change2.append(anchor2);
    document.querySelector("#shiptotr").append(shipto, shiptotext, change2);
  }

  var totalprice = JSON.parse(localStorage.getItem("total-price"));
  function method1fun() {
    localStorage.setItem("method", "Ground Shipping (7-10 days)");
  }

  function method2fun() {
    totalprice = Number(totalprice) + Number(10);
    localStorage.setItem("total-price", totalprice);
    localStorage.setItem(
      "method",
      "Two-Day Shipping (Excludes PO Box or APO/FPO)"
    );
  }

  var data = JSON.parse(localStorage.getItem("cart-items")) || [];
  var totalprice = JSON.parse(localStorage.getItem("total-price"));
  console.log(totalprice);
  displaycart(data);
  function displaycart(arr) {
    arr.map(function (elem, ind) {
      var tr = document.createElement("tr");
      var td1 = document.createElement("td");
      var div = document.createElement("div");
      div.setAttribute("id", "td1");
      var img = document.createElement("img");
      img.setAttribute("src", elem.img);
      img.setAttribute("id", "cartimg");
      var div2 = document.createElement("div");
      div2.setAttribute("id", "carttext");
      var name = document.createElement("p");
      name.textContent = elem.name;
      var desc = document.createElement("p");
      desc.textContent = elem.desc;
      div2.append(name, desc);
      div.append(img, div2);
      td1.append(div);
      var td2 = document.createElement("td");
      var prodprice = Number(elem.price) * Number(elem.qty);
      td2.innerText = "$" + prodprice;
      tr.append(td1, td2);
      document.querySelector("#carttablebody").append(tr);
    });
  }
  document.querySelector("#promobutton").addEventListener("click", promofunc);
  function promofunc() {
    var promo = document.querySelector("#promocode");
    console.log(promo.value);
    if (promo.value != "") {
      promo.value = "";
    }
    if (promo.value === "blue20") {
      alert("20% off on your bag");
      totalprice = (totalprice - totalprice * 0.2).toFixed(0);
      document.querySelector("#subtot").textContent = "$" + totalprice;
      document.querySelector("#totprice").textContent = "USD $" + totalprice;
    } else {
      alert("Invalid Promo Code");
    }
  }
</script>
