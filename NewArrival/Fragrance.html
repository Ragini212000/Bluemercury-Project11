<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script
      src="https://kit.fontawesome.com/6c1f5c4092.js"
      crossorigin="anonymous"
    ></script>
    <style>
      #container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        width: 60%;
        margin: auto;
      }
      .product-container {
        display: flex;
        flex-direction: column;
      }
      .image {
        width: 100%;
      }
      .head {
        display: flex;
        justify-content: space-around;
      }
    </style>
  </head>
  <body>
    <div id="left-box"></div>
    <div id="right-box">
      <div id="header">
        <h1>NEW ARRIVAL</h1>
        <div>
          <p>SORT BY</p>
          <select name="" id="filter">
            <option value="Featured">Featured</option>
            <option value="New Arrivals">New Arrivals</option>
            <option value="Best Sellers">Best Sellers</option>
            <option value="Low to High">Price, Low to High</option>
            <option value="High to Low">Price, High to Low</option>
          </select>
        </div>
      </div>
      <div id="container"></div>
    </div>
  </body>
  <script>
    var All = JSON.parse(localStorage.getItem("mainProducts"));
    var PageName = "Fragrance";
    var pageCategory = [
      "Skincare",
      "HairCare",
      "Makeup",
      "Fragrance",
      "Bath&Body",
      "Tools&Accessories",
      "NEW",
    ];
    var PageProducts = All.filter((element) => {
      return element.pageCategory === "Fragrance";
    });
    console.log(PageProducts);
    displayProducts(PageProducts);

    // Display function
    function displayProducts(arr, index) {
      document.getElementById("container").innerHTML = "";
      arr.map((element, index) => {
        const container = document.getElementById("container");

        container.innerHTML += `
    <div class="product-container>
        <i class=""></i>     
        <p class="head">${element.merchbadge}<i class="fa-solid fa-2x fa-heart" id="heart${index}" onclick="whistlist(PageProducts[${index}], ${index})"></i></p>
        <p>${element.merchbadge1}</p>     
        <img src="${element.Image}" alt="${element.Title}" class="image"/>
        <h3>${element.productcard__brand}</h3>
        <p>${element.Title}</p>
        <p>$${element.Price}</p>
    </div>

`;
      });
    }
    //Addding to Whistlist
    function whistlist(element, ind) {
      document.getElementById("heart" + ind).style.color = "red";
      console.log(element);
    }

    //First Filter
    const filter = document.getElementById("filter");
    filter.addEventListener("change", () => {
      let value = filter.value;
      let newProductArray = [];
      if (value === "Low to High" || value === "High to Low") {
        // sorting
        if (value === "Low to High") {
          PageProducts.sort((a, b) => {
            return a.Price - b.Price;
          });
        } else {
          PageProducts.sort((a, b) => {
            return b.Price - a.Price;
          });
        }
        displayProducts(PageProducts);
      } else {
        //Filtering
        if (value === "Featured") {
          newProductArray = All.filter((element) => {
            return element.merchbadge1 === "LIMITED EDITION";
          });
        } else if (value === "New Arrivals") {
          newProductArray = All.filter((element) => {
            return element.merchbadge === "NEW";
          });
        } else if (value === "Best Sellers") {
          newProductArray = All.filter((element) => {
            return element.merchbadge1 === "CONSCIOUS BEAUTY";
          });
        }
        displayProducts(newProductArray);
      }
    });
  </script>
</html>
